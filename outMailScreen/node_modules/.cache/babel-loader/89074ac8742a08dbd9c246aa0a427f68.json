{"remainingRequest":"D:\\mail\\oesbecc\\outMailScreen\\node_modules\\thread-loader\\dist\\cjs.js!D:\\mail\\oesbecc\\outMailScreen\\node_modules\\babel-loader\\lib\\index.js!D:\\mail\\oesbecc\\outMailScreen\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\mail\\oesbecc\\outMailScreen\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\mail\\oesbecc\\outMailScreen\\src\\views\\mailCfgInfo\\edit.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\mail\\oesbecc\\outMailScreen\\src\\views\\mailCfgInfo\\edit.vue","mtime":1641431074323},{"path":"D:\\mail\\oesbecc\\outMailScreen\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1640070690350},{"path":"D:\\mail\\oesbecc\\outMailScreen\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1640070694039},{"path":"D:\\mail\\oesbecc\\outMailScreen\\node_modules\\babel-loader\\lib\\index.js","mtime":1640070643981},{"path":"D:\\mail\\oesbecc\\outMailScreen\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1640070690350},{"path":"D:\\mail\\oesbecc\\outMailScreen\\node_modules\\vue-loader\\lib\\index.js","mtime":1640070694148}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"D:\\\\mail\\\\oesbecc\\\\outMailScreen\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { updateMailCfgInfo, updateMailCfgImg, getImgById } from '@/api/mailCfgInfo.js';\nimport moment from 'moment';\n\nfunction getBase64(file) {\n  return new Promise(function (resolve, reject) {\n    var reader = new FileReader();\n    reader.readAsDataURL(file);\n\n    reader.onload = function () {\n      return resolve(reader.result);\n    };\n\n    reader.onerror = function (error) {\n      return reject(error);\n    };\n  });\n}\n\nexport default {\n  data: function data() {\n    return {\n      showUploadList: {\n        showRemoveIcon: false\n      },\n      showUpload: false,\n      disabled: '',\n      disabled1: '',\n      showVisible: false,\n      form: this.$form.createForm(this),\n      hackRest: false,\n      dialogType: '',\n      dialogTypeMap: {\n        show: '邮件详情',\n        create: '邮件新增',\n        update: '邮件修改',\n        updateImg: '修改背景图片'\n      },\n      SubmitTypeMap: {\n        show: '关闭',\n        create: '确认新增',\n        update: '确认修改',\n        updateImg: '关闭'\n      },\n      showCanel: true,\n      rule: {\n        id: {\n          rules: [{\n            required: true,\n            message: '请输入员工编号'\n          }],\n          initialValue: ''\n        },\n        title: {\n          rules: [{\n            required: true,\n            message: '请输入邮箱主题'\n          }],\n          initialValue: ''\n        },\n        pubMail: {\n          rules: [{\n            required: true,\n            message: '请输入发件邮箱'\n          }],\n          initialValue: ''\n        },\n        pubMailPass: {\n          rules: [{\n            required: true,\n            message: '请输入邮箱密码'\n          }],\n          initialValue: ''\n        },\n        sendTime: {\n          rules: [{\n            required: true,\n            message: '请输入发送时间'\n          }],\n          initialValue: ''\n        },\n        desxp: {\n          rules: [{\n            required: false,\n            message: '请输入发送时间'\n          }],\n          initialValue: ''\n        },\n        modelContent: {\n          rules: [{\n            required: true,\n            message: '请输入模板内容'\n          }],\n          initialValue: ''\n        },\n        status: {\n          rules: [{\n            required: true,\n            message: '请选择在职状态'\n          }],\n          initialValue: '1'\n        }\n      },\n      previewVisible: false,\n      previewImage: '',\n      fileList: []\n    };\n  },\n  methods: {\n    moment: moment,\n    //查看\n    ShowDialog: function ShowDialog(query) {\n      var _this = this;\n\n      this.disabled = true;\n      this.disabled1 = true;\n      this.showUpload = false;\n      this.showCanel = false;\n      this.showVisible = true;\n      this.iconType = \"copy\";\n      this.dialogType = 'show';\n      this.timeTask = query;\n      this.$nextTick(function () {\n        _this.hackRest = true;\n\n        _this.form.setFieldsValue(query);\n\n        _this.fileFormatter();\n      });\n    },\n    UpdateImgDialog: function UpdateImgDialog(query) {\n      var _this2 = this;\n\n      this.disabled = true;\n      this.disabled1 = true;\n      this.showUpload = true;\n      this.showCanel = false;\n      this.showVisible = true;\n      this.iconType = \"copy\";\n      this.dialogType = 'updateImg';\n      this.timeTask = query;\n      this.$nextTick(function () {\n        _this2.hackRest = true;\n\n        _this2.form.setFieldsValue(query);\n\n        _this2.fileFormatter();\n      });\n    },\n    //\n    CreateDialog: function CreateDialog() {\n      this.iconType = \"form\";\n      this.showCanel = true;\n      this.disabled = false;\n      this.disabled1 = false;\n      this.showVisible = true;\n      this.dialogType = 'create';\n      this.form.resetFields(); //清除缓存数据\n    },\n    //修改\n    UpdateDialog: function UpdateDialog(query) {\n      var _this3 = this;\n\n      this.iconType = \"form\";\n      this.showCanel = true;\n      this.disabled = false;\n      this.disabled1 = true;\n      this.showUpload = false;\n      this.showVisible = true;\n      this.dialogType = 'update';\n      this.timeTask = query;\n      this.$nextTick(function () {\n        _this3.hackRest = true;\n\n        _this3.form.setFieldsValue(query);\n\n        _this3.fileFormatter();\n      });\n    },\n    //关闭\n    onClose: function onClose() {\n      this.showVisible = false;\n      this.form.resetFields();\n    },\n    //提交按钮\n    onSubmit: function onSubmit() {\n      if (this.dialogType == 'show' || this.dialogType == 'updateImg') {\n        this.showVisible = false;\n      }\n\n      if (this.dialogType == 'create') {\n        this.create();\n      }\n\n      if (this.dialogType == 'update') {\n        this.update();\n      }\n    },\n    //修改\n    update: function update() {\n      var _this4 = this;\n\n      this.form.validateFields(function (err, values) {\n        if (!err) {\n          updateMailCfgInfo(values).then(function (res) {\n            //console.log(res)\n            if (res.data.code == '0000') {\n              _this4.$message.success(res.data.message);\n\n              _this4.$emit('fresh');\n            } else {\n              _this4.$message.error(res.data.message);\n            }\n          });\n          _this4.showVisible = false;\n        }\n      });\n    },\n    handleCancel: function handleCancel() {\n      this.previewVisible = false;\n    },\n    handlePreview: function () {\n      var _handlePreview = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee(file) {\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!(!file.url && !file.preview)) {\n                  _context.next = 4;\n                  break;\n                }\n\n                _context.next = 3;\n                return getBase64(file.originFileObj);\n\n              case 3:\n                file.preview = _context.sent;\n\n              case 4:\n                this.previewImage = file.url || file.preview;\n                this.previewVisible = true;\n\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function handlePreview(_x) {\n        return _handlePreview.apply(this, arguments);\n      }\n\n      return handlePreview;\n    }(),\n    handleChange: function handleChange(_ref) {\n      var fileList = _ref.fileList;\n      this.fileList = fileList;\n    },\n    downloadFilesCustomRequest: function downloadFilesCustomRequest(data) {\n      var _this5 = this;\n\n      var formData = new FormData();\n      formData.append('file', data.file);\n      formData.append('id', this.form.getFieldValue(\"id\"));\n      updateMailCfgImg(formData).then(function (res) {\n        if (res.data.code == '0000') {\n          _this5.$message.success(res.data.message);\n\n          _this5.fileFormatter();\n        } else {\n          _this5.$message.error(res.data.message);\n        }\n      });\n      return;\n    },\n    fileFormatter: function fileFormatter() {\n      var _this6 = this;\n\n      //下载文件\n      getImgById({\n        id: this.form.getFieldValue(\"id\")\n      }).then(function (res) {\n        var file = {\n          uid: '1',\n          // 文件唯一标识，建议设置为负数，防止和内部产生的 id 冲突\n          name: '背景图片',\n          // 文件名\n          status: 'done' // 状态有：uploading done error removed\n\n        };\n        var blob = new Blob([res.data]);\n        var href = window.URL.createObjectURL(blob);\n        file.url = href;\n        _this6.fileList = [];\n\n        _this6.fileList.push(file);\n      });\n    }\n  }\n};",{"version":3,"sources":["edit.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n\r\n  <a-drawer placement=\"right\" :closable=\"true\" @close=\"onClose\" :visible=\"showVisible\" width=\"700px\">\r\n\t\t<span slot=\"title\">\r\n\t\t\t<a-icon :type=\"iconType\"/>&nbsp; {{ dialogTypeMap[dialogType] }}\r\n\r\n\t\t</span>\r\n\r\n    <a-form class=\"ant-advanced-search-form\" style=\"border:none;\" :form=\"form\">\r\n      <a-row :gutter=\"24\">\r\n        <a-col :span=\"12\">\r\n          <a-form-item label=\"邮箱编号\" :label-col=\"{ span: 8 }\" :wrapper-col=\"{ span: 16 }\">\r\n            <a-input placeholder=\"请输入邮箱编号\" :disabled=\"disabled1\" v-decorator=\"['id',rule.id]\"/>\r\n          </a-form-item>\r\n        </a-col>\r\n\r\n        <a-col :span=\"12\">\r\n          <a-form-item label=\"发件邮箱\" :label-col=\"{ span: 8 }\" :wrapper-col=\"{ span: 16 }\">\r\n            <a-input placeholder=\"请输入发件邮箱\" :disabled=\"disabled\" v-decorator=\"['pubMail',rule.pubMail]\"/>\r\n          </a-form-item>\r\n        </a-col>\r\n\r\n        <a-col :span=\"12\">\r\n          <a-form-item label=\"邮箱密码\" :label-col=\"{ span: 8 }\" :wrapper-col=\"{ span: 16 }\">\r\n            <a-input type=\"password\" placeholder=\"请输入发件邮箱密码\" :disabled=\"disabled\" v-decorator=\"['pubMailPass',rule.pubMailPass]\"/>\r\n          </a-form-item>\r\n        </a-col>\r\n\r\n\r\n\r\n<!--        <a-col :span=\"24\">\r\n          <a-form-item label=\"出生日期\" :label-col=\"{ span: 4 }\" :wrapper-col=\"{ span: 12 }\">\r\n            <a-date-picker placeholder=\"请输入出生日期\" style=\"width:100%\" :disabled=\"disabled\"\r\n                           v-decorator=\"['birth',rule.birth]\"/>\r\n          </a-form-item>\r\n        </a-col>\r\n\r\n        <a-col :span=\"24\">\r\n          <a-form-item label=\"入职日期\" :label-col=\"{ span: 4 }\" :wrapper-col=\"{ span: 12 }\">\r\n            <a-date-picker placeholder=\"请输入入职日期\" style=\"width:100%\" :disabled=\"disabled\"\r\n                           v-decorator=\"['entry',rule.entry]\"/>\r\n          </a-form-item>\r\n        </a-col>-->\r\n\r\n        <a-col :span=\"12\">\r\n          <a-form-item label=\"发送时间\" :label-col=\"{ span: 8 }\" :wrapper-col=\"{ span: 16 }\">\r\n            <a-time-picker\r\n                            format=\"HH:mm\" placeholder=\"请输入发送时间\"\r\n                            :default-value=\"moment('12:08', 'HH:mm')\"\r\n                            style=\"width:100%\"\r\n                            :disabled=\"disabled\"\r\n                            valueFormat=\"HH:mm\"\r\n                           v-decorator=\"['sendTime',rule.sendTime]\"/>\r\n          </a-form-item>\r\n        </a-col>\r\n        <a-col :span=\"24\">\r\n          <a-form-item label=\"邮箱主题\" :label-col=\"{ span: 4 }\" :wrapper-col=\"{ span: 20 }\">\r\n            <a-input  placeholder=\"请输入邮箱主题\" :disabled=\"disabled\" v-decorator=\"['title',rule.title]\"/>\r\n          </a-form-item>\r\n        </a-col>\r\n\r\n<!--        <a-col :span=\"24\">\r\n          <a-form-item label=\"模板内容\" :label-col=\"{ span: 4 }\" :wrapper-col=\"{ span: 20 }\">\r\n            <a-input type=\"textarea\" :auto-size=\"{ minRows: 5}\"  placeholder=\"请输入模板内容\" :disabled=\"disabled\" v-decorator=\"['modelContent',rule.modelContent]\"/>\r\n          </a-form-item>\r\n        </a-col>-->\r\n\r\n        <a-col :span=\"12\">\r\n          <a-form-item label=\"邮件类型\" :label-col=\"{ span: 8 }\" :wrapper-col=\"{ span: 16 }\">\r\n            <template>\r\n              <a-radio-group name='status' :disabled=\"disabled1\" v-decorator=\"['mailType',rule.mailType]\">\r\n                <a-radio value=\"0\">生日祝福</a-radio>\r\n                <a-radio value=\"1\">感谢信</a-radio>\r\n              </a-radio-group>\r\n            </template>\r\n          </a-form-item>\r\n        </a-col>\r\n        <a-col :span=\"12\">\r\n          <a-form-item label=\"备注\" :label-col=\"{ span: 8 }\" :wrapper-col=\"{ span: 16 }\">\r\n            <a-input placeholder=\"请输入描述信息\" :disabled=\"disabled\" v-decorator=\"['descx',rule.descx]\"/>\r\n          </a-form-item>\r\n        </a-col>\r\n\r\n      <a-col :span=\"24\">\r\n        <a-form-item label=\"背景图片\" :label-col=\"{ span: 4 }\" :wrapper-col=\"{ span: 12 }\">\r\n          <template>\r\n            <a-upload\r\n                list-type=\"picture-card\"\r\n                :file-list=\"fileList\"\r\n                :showUploadList=showUploadList\r\n                @preview=\"handlePreview\"\r\n                :customRequest=\"downloadFilesCustomRequest\" >\r\n              <div v-if=\"showUpload\">\r\n                <a-icon type=\"plus\" />\r\n                <div class=\"ant-upload-text\">\r\n                  上传背景图片\r\n                </div>\r\n              </div>\r\n            </a-upload>\r\n          </template>\r\n        </a-form-item>\r\n      </a-col>\r\n      </a-row>\r\n\r\n\r\n    </a-form>\r\n\r\n\r\n    <div class=\"clearfix\">\r\n\r\n      <a-modal :visible=\"previewVisible\" :footer=\"null\" @cancel=\"handleCancel\">\r\n        <img alt=\"example\" style=\"width: 100%\" :src=\"previewImage\" />\r\n      </a-modal>\r\n    </div>\r\n\r\n\r\n\r\n    <div :style=\"{\r\n                 position: 'absolute',\r\n                 left: 0,\r\n                 bottom: 0,\r\n                 width: '100%',\r\n                 borderTop: '1px solid #e9e9e9',\r\n                 padding: '10px 16px',\r\n                 background: '#fff',\r\n                 textAlign: 'right',\r\n               }\">\r\n      <a-button :style=\"{marginRight: '8px'}\" @click=\"onClose\" v-if=\"showCanel\"> 取消</a-button>\r\n      <a-button @click=\"onSubmit\" type=\"primary\">{{ SubmitTypeMap[dialogType] }}</a-button>\r\n    </div>\r\n\r\n  </a-drawer>\r\n\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  updateMailCfgInfo,updateMailCfgImg,getImgById\r\n} from '@/api/mailCfgInfo.js';\r\n\r\nimport moment from 'moment'\r\nfunction getBase64(file) {\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    reader.readAsDataURL(file);\r\n    reader.onload = () => resolve(reader.result);\r\n    reader.onerror = error => reject(error);\r\n  });\r\n}\r\nexport default {\r\n  data() {\r\n    return {\r\n      showUploadList:{\r\n        showRemoveIcon:false\r\n      },\r\n      showUpload:false,\r\n\r\n      disabled: '',\r\n      disabled1: '',\r\n      showVisible: false,\r\n      form: this.$form.createForm(this),\r\n      hackRest: false,\r\n      dialogType: '',\r\n      dialogTypeMap: {\r\n        show: '邮件详情',\r\n        create: '邮件新增',\r\n        update: '邮件修改',\r\n        updateImg:'修改背景图片'\r\n      },\r\n      SubmitTypeMap: {\r\n        show: '关闭',\r\n        create: '确认新增',\r\n        update: '确认修改',\r\n        updateImg:'关闭'\r\n      },\r\n      showCanel: true,\r\n      rule: {\r\n        id: {\r\n          rules: [{\r\n            required: true,\r\n            message: '请输入员工编号'\r\n          }],\r\n          initialValue: ''\r\n        },\r\n        title: {\r\n          rules: [{\r\n            required: true,\r\n            message: '请输入邮箱主题'\r\n          }],\r\n          initialValue: ''\r\n        },\r\n        pubMail: {\r\n          rules: [{\r\n            required: true,\r\n            message: '请输入发件邮箱'\r\n          }],\r\n          initialValue: ''\r\n        },\r\n        pubMailPass: {\r\n          rules: [{\r\n            required: true,\r\n            message: '请输入邮箱密码'\r\n          }],\r\n          initialValue: ''\r\n        },\r\n        sendTime: {\r\n          rules: [{\r\n            required: true,\r\n            message: '请输入发送时间'\r\n          }],\r\n          initialValue: ''\r\n        },\r\n        desxp: {\r\n          rules: [{\r\n            required: false,\r\n            message: '请输入发送时间'\r\n          }],\r\n          initialValue: ''\r\n        },\r\n        modelContent: {\r\n          rules: [{\r\n            required: true,\r\n            message: '请输入模板内容'\r\n          }],\r\n          initialValue: ''\r\n        },\r\n\r\n\r\n        status: {\r\n          rules: [{\r\n            required: true,\r\n            message: '请选择在职状态'\r\n          }],\r\n          initialValue: '1'\r\n        },\r\n      },\r\n      previewVisible: false,\r\n      previewImage: '',\r\n      fileList: [\r\n      ],\r\n    }\r\n  },\r\n  methods: {\r\n    moment,\r\n    //查看\r\n    ShowDialog(query) {\r\n      this.disabled = true\r\n      this.disabled1 = true\r\n      this.showUpload=false\r\n      this.showCanel = false\r\n      this.showVisible = true\r\n      this.iconType = \"copy\";\r\n      this.dialogType = 'show'\r\n      this.timeTask = query\r\n      this.$nextTick(() => {\r\n        this.hackRest = true;\r\n        this.form.setFieldsValue(query);\r\n        this.fileFormatter();\r\n      });\r\n    },\r\n\r\n    UpdateImgDialog(query) {\r\n      this.disabled = true\r\n      this.disabled1 = true\r\n      this.showUpload=true\r\n      this.showCanel = false\r\n      this.showVisible = true\r\n      this.iconType = \"copy\";\r\n      this.dialogType = 'updateImg'\r\n      this.timeTask = query\r\n      this.$nextTick(() => {\r\n        this.hackRest = true;\r\n        this.form.setFieldsValue(query);\r\n        this.fileFormatter();\r\n      });\r\n    },\r\n\r\n    //\r\n    CreateDialog() {\r\n      this.iconType = \"form\";\r\n      this.showCanel = true\r\n      this.disabled = false\r\n      this.disabled1 = false\r\n      this.showVisible = true\r\n      this.dialogType = 'create'\r\n      this.form.resetFields(); //清除缓存数据\r\n    },\r\n    //修改\r\n    UpdateDialog(query) {\r\n      this.iconType = \"form\";\r\n      this.showCanel = true\r\n      this.disabled = false\r\n      this.disabled1 = true\r\n      this.showUpload=false\r\n      this.showVisible = true\r\n      this.dialogType = 'update'\r\n      this.timeTask = query\r\n      this.$nextTick(() => {\r\n        this.hackRest = true;\r\n        this.form.setFieldsValue(query);\r\n        this.fileFormatter();\r\n      });\r\n\r\n    },\r\n    //关闭\r\n    onClose() {\r\n      this.showVisible = false;\r\n      this.form.resetFields();\r\n    },\r\n    //提交按钮\r\n    onSubmit() {\r\n      if (this.dialogType == 'show' ||this.dialogType =='updateImg') {\r\n        this.showVisible = false\r\n      }\r\n      if (this.dialogType == 'create') {\r\n        this.create();\r\n      }\r\n      if (this.dialogType == 'update') {\r\n        this.update();\r\n      }\r\n    },\r\n\r\n    //修改\r\n    update() {\r\n      this.form.validateFields((err, values) => {\r\n        if (!err) {\r\n          updateMailCfgInfo(values).then(res => {\r\n            //console.log(res)\r\n            if (res.data.code == '0000') {\r\n              this.$message.success(res.data.message)\r\n              this.$emit('fresh')\r\n            } else {\r\n              this.$message.error(res.data.message)\r\n            }\r\n          })\r\n          this.showVisible = false\r\n        }\r\n      });\r\n    },\r\n\r\n    handleCancel() {\r\n      this.previewVisible = false;\r\n    },\r\n    async handlePreview(file) {\r\n      if (!file.url && !file.preview) {\r\n        file.preview = await getBase64(file.originFileObj);\r\n      }\r\n      this.previewImage = file.url || file.preview;\r\n      this.previewVisible = true;\r\n    },\r\n    handleChange({ fileList }) {\r\n      this.fileList = fileList;\r\n    },\r\n\r\n    downloadFilesCustomRequest(data){\r\n\r\n\r\n      const formData = new FormData()\r\n      formData.append('file', data.file);\r\n      formData.append('id', this.form.getFieldValue(\"id\"));\r\n\r\n      updateMailCfgImg(formData).then(res => {\r\n        if (res.data.code == '0000') {\r\n          this.$message.success(res.data.message)\r\n          this.fileFormatter()\r\n        } else {\r\n          this.$message.error(res.data.message)\r\n        }\r\n\r\n\r\n\r\n      })\r\n      return;\r\n    },\r\n\r\n    fileFormatter() {\r\n      //下载文件\r\n      getImgById({id:this.form.getFieldValue(\"id\")}).then(res=>{\r\n        let file = {\r\n          uid: '1',    // 文件唯一标识，建议设置为负数，防止和内部产生的 id 冲突\r\n          name: '背景图片',   // 文件名\r\n          status: 'done', // 状态有：uploading done error removed\r\n        }\r\n        const blob = new Blob([res.data]);\r\n        var href = window.URL.createObjectURL(blob);\r\n        file.url = href;\r\n        this.fileList =[];\r\n        this.fileList.push(file);\r\n      })\r\n\r\n    },\r\n\r\n  }\r\n}\r\n</script>\r\n"],"sourceRoot":"src/views/mailCfgInfo"}]}