{"remainingRequest":"D:\\oesbecc\\outScreen\\node_modules\\babel-loader\\lib\\index.js!D:\\oesbecc\\outScreen\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\oesbecc\\outScreen\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\oesbecc\\outScreen\\src\\views\\role\\edit.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\oesbecc\\outScreen\\src\\views\\role\\edit.vue","mtime":1637304821604},{"path":"D:\\oesbecc\\outScreen\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1626312140594},{"path":"D:\\oesbecc\\outScreen\\node_modules\\babel-loader\\lib\\index.js","mtime":1626312110547},{"path":"D:\\oesbecc\\outScreen\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1626312140594},{"path":"D:\\oesbecc\\outScreen\\node_modules\\vue-loader\\lib\\index.js","mtime":1626312141896}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { addRole, updateRole, getMenuByRoleId } from '@/api/system.js';\nexport default {\n  data: function data() {\n    var _this = this;\n\n    return {\n      form: this.$form.createForm(this),\n      dialogTypeMap: {\n        show: '角色详情',\n        create: '角色新增',\n        update: '角色修改'\n      },\n      hackRest: false,\n      columns: [{\n        title: '菜单ID',\n        dataIndex: 'id',\n        align: 'center'\n      }, {\n        title: '菜单名称',\n        dataIndex: 'name',\n        align: 'center'\n      }, {\n        title: '菜单路径',\n        dataIndex: 'path',\n        align: 'center'\n      }, {\n        title: '菜单类型',\n        dataIndex: 'type',\n        align: 'center',\n        scopedSlots: {\n          customRender: 'type'\n        }\n      }, {\n        title: '父菜单',\n        dataIndex: 'parentName',\n        align: 'center'\n      }, {\n        title: '菜单图标',\n        dataIndex: 'icon',\n        align: 'center',\n        width: '90px',\n        scopedSlots: {\n          customRender: 'icon'\n        }\n      }, {\n        title: '状态',\n        dataIndex: 'status',\n        align: 'center',\n        scopedSlots: {\n          customRender: 'status'\n        }\n      }],\n      listQuery: {\n        page: 1,\n        pageSize: 5,\n        roleId: ''\n      },\n      query: {},\n      list: [],\n      pagination: {\n        total: 0,\n        defaultPageSize: 5,\n        showTotal: function showTotal(total) {\n          return \"\\u5171 \".concat(total, \" \\u6761\\u6570\\u636E\");\n        },\n        showSizeChanger: true,\n        pageSizeOptions: ['5', '10', '15', '20'],\n        onChange: function onChange(page, pageSize) {\n          _this.pagechage(page, pageSize);\n        },\n        onShowSizeChange: function onShowSizeChange(current, pageSize) {\n          _this.pageSizeChange(pageSize);\n        }\n      },\n      SubmitTypeMap: {\n        show: '确认',\n        create: '提交',\n        update: '提交'\n      },\n      statusmap: {\n        '0': '停用',\n        '1': '启用'\n      },\n      typemap: {\n        '0': '一级菜单',\n        '1': '二级菜单'\n      },\n      showVisible: false,\n      rule: {\n        name: {\n          rules: [{\n            required: true,\n            message: '请输入角色姓名'\n          }],\n          initialValue: ''\n        },\n        desc: {\n          rules: [{\n            required: true,\n            message: '请输入角色描述'\n          }],\n          initialValue: ''\n        },\n        status: {\n          rules: [{\n            required: true,\n            message: '请输入角色状态'\n          }],\n          initialValue: ''\n        }\n      }\n    };\n  },\n  props: {\n    showVisible: Boolean\n  },\n  methods: {\n    //查看\n    ShowDialog: function ShowDialog(query) {\n      var _this2 = this;\n\n      this.disabled = true;\n      this.showVisible = true;\n      this.dialogType = 'show';\n      this.query = query;\n      this.getList(query);\n      this.$nextTick(function () {\n        _this2.form.setFieldsValue(query);\n      });\n    },\n    //获取关联角色信息\n    getList: function getList() {\n      var _this3 = this;\n\n      this.loading = true;\n      this.listQuery.roleId = this.query.id;\n      getMenuByRoleId(this.listQuery).then(function (res) {\n        if (res.data.code == '0000') {\n          _this3.loading = false;\n          console.log(res);\n          _this3.list = res.data.extend.list;\n          _this3.pagination.total = res.data.extend.total;\n        } else {\n          _this3.loading = false;\n\n          _this3.$message.error(res.data.message);\n        }\n      });\n    },\n    //新增\n    CreateDialog: function CreateDialog() {\n      this.disabled = false;\n      this.showVisible = true;\n      this.dialogType = 'create';\n    },\n    //修改\n    UpdateDialog: function UpdateDialog(query) {\n      var _this4 = this;\n\n      this.disabled = false;\n      this.showVisible = true;\n      this.dialogType = 'update';\n      this.$nextTick(function () {\n        _this4.hackRest = true;\n\n        _this4.form.setFieldsValue(query);\n      });\n    },\n    //关闭\n    onClose: function onClose() {\n      this.showVisible = false;\n      this.form.resetFields();\n    },\n    //提交按钮\n    onSubmit: function onSubmit() {\n      if (this.dialogType == 'show') {\n        this.showVisible = false;\n      }\n\n      if (this.dialogType == 'create') {\n        this.create();\n      }\n\n      if (this.dialogType == 'update') {\n        this.update();\n      }\n    },\n    create: function create() {\n      var _this5 = this;\n\n      this.form.validateFields(function (err, values) {\n        if (err) {\n          _this5.$message.error(\"新增失败！\");\n        } else {\n          // var listArry=this.form.getFieldsValue()\n          //console.log(listArry)\n          addRole(values).then(function (res) {\n            if (res.status == 200) {\n              _this5.$message.success('新增成功！');\n\n              _this5.$emit('fresh');\n            } else {\n              _this5.$message.error('新增失败！');\n            }\n          });\n          _this5.showVisible = false;\n        }\n      });\n    },\n    update: function update() {\n      var _this6 = this;\n\n      this.form.validateFields(function (err, values) {\n        console.info(values); //  var listArry=this.form.getFieldsValue()\n\n        updateRole(values).then(function (res) {\n          if (res.status == 200) {\n            _this6.$message.success('修改成功！');\n\n            _this6.$emit('fresh');\n\n            _this6.showVisible = false;\n          } else {\n            _this6.$message.error('修改失败！');\n\n            _this6.showVisible = false;\n          }\n        });\n      }); //end update\n    },\n    pageSizeChange: function pageSizeChange(pageSize) {\n      this.listQuery.pageNum = 1;\n      this.listQuery.pageSize = pageSize;\n      this.getList();\n    },\n    pagechage: function pagechage(pageNum, pageSize) {\n      this.listQuery.pageNum = pageNum;\n      this.listQuery.pageSize = pageSize;\n      this.getList();\n    }\n  }\n};",{"version":3,"sources":["edit.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n\r\n  <a-drawer\r\n      class=\"padding20\"\r\n\t\t placement=\"right\"\r\n\t\t :closable=\"true\"\r\n\t\t @close=\"onClose\"\r\n\t\t :visible=\"showVisible\"\r\n\t\t width=\"1100px\">\r\n\t\t <span slot=\"title\">\r\n\t\t\t<a-icon type=\"form\"/>&nbsp; {{dialogTypeMap[dialogType]}}\r\n\r\n\t\t </span>\r\n\r\n\r\n\r\n\t<a-tabs >\r\n\t<a-tab-pane tab=\"角色信息\">\r\n\t\t<a-form :form=\"form\">\r\n\t\t  <a-row :gutter=\"24\">\r\n\r\n\r\n\t\t\t<a-col :span=\"24\">\r\n\t\t\t  <a-form-item label=\"角色名称\" :label-col=\"{ span: 4 }\" :wrapper-col=\"{ span: 20 }\">\r\n\t\t\t\t   <a-input type=\"hidden\"   v-decorator=\"['id']\"/>\r\n\t\t\t\t<a-input  placeholder=\"请输入角色名称\"  :disabled=\"disabled\" v-decorator=\"['name',rule.name]\"  />\r\n\t\t\t  </a-form-item>\r\n\t\t\t</a-col>\r\n\t\t\t<a-col :span=\"24\">\r\n\t\t\t  <a-form-item label=\"角色描述\" :label-col=\"{ span: 4 }\" :wrapper-col=\"{ span: 20 }\">\r\n\t\t\t\t<a-input  placeholder=\"请输入角色描述\"  :disabled=\"disabled\" v-decorator=\"['desc',rule.desc]\"  />\r\n\t\t\t  </a-form-item>\r\n\t\t\t</a-col>\r\n\r\n\t\t\t<a-col :span=\"24\">\r\n\t\t\t  <a-form-item label=\"状态\" :label-col=\"{ span: 4 }\" :wrapper-col=\"{ span: 20 }\">\r\n\t\t\t\t<a-radio-group   :disabled=\"disabled\" v-decorator=\"['status',rule.status]\" >\r\n\t\t\t\t  <a-radio value=\"0\">禁用</a-radio>\r\n\t\t\t\t  <a-radio value=\"1\">启用</a-radio>\r\n\t\t\t\t</a-radio-group>\r\n\t\t\t  </a-form-item>\r\n\t\t\t</a-col>\r\n\t\t  </a-row>\r\n\t\t</a-form>\r\n\r\n\t</a-tab-pane>\r\n\t</a-tabs>\r\n\r\n\t<a-tabs calss=\"padding20\">\r\n\t\t<a-tab-pane tab=\" 菜单信息 \">\r\n\t\t\t<a-table class=\"padding20\" :columns=\"columns\" :dataSource=\"list\" bordered :pagination=\"pagination\">\r\n\t\t\t  <span slot=\"icon\" slot-scope=\"icon\">\r\n\t\t\t      <a-icon  :type=\"icon\"/>\r\n\t\t\t  </span>\r\n\t\t\t  <span slot=\"status\" slot-scope=\"status\">\r\n\t\t\t       <a-badge :status=\"status=='1'?'success':'error'\" />\r\n\t\t\t      {{statusmap[status]}}\r\n\t\t\t  </span>\r\n\t\t\t\t\t<span slot=\"type\" slot-scope=\"type\">\r\n\t\t\t\t\t    {{typemap[type]}}\r\n\t\t\t\t\t</span>\r\n\r\n\t\t\t  <span slot=\"operation\" slot-scope=\"text, record\">\r\n\t\t\t  <a  @click=\"showlist(record)\">查看</a>\r\n\t\t\t  <a-divider type=\"vertical\" />\r\n\t\t\t  <a-dropdown>\r\n\t\t\t    <a class=\"ant-dropdown-link\" href=\"javascript:;\">\r\n\t\t\t    更多 <a-icon type=\"down\" />\r\n\t\t\t    </a>\r\n\t\t\t    <a-menu slot=\"overlay\">\r\n\t\t\t    <a-menu-item>\r\n\t\t\t      <a href=\"javascript:;\" @click=\"update(record)\">修改</a>\r\n\t\t\t    </a-menu-item>\r\n\t\t\t    <a-menu-item>\r\n\t\t\t      <a href=\"javascript:;\" @click=\"deletList(record)\">删除</a>\r\n\t\t\t    </a-menu-item>\r\n\t\t\t    </a-menu>\r\n\t\t\t  </a-dropdown>\r\n\t\t\t    </span>\r\n\t\t\t</a-table>\r\n\t\t</a-tab-pane>\r\n\t</a-tabs>\r\n\r\n    <div class=\"modeButton\">\r\n      <a-button :style=\"{marginRight: '8px'}\"\r\n                @click=\"onClose\">\r\n        取消\r\n      </a-button>\r\n      <a-button @click=\"onSubmit\" type=\"primary\">{{SubmitTypeMap[dialogType]}}</a-button>\r\n    </div>\r\n  </a-drawer>\r\n\r\n</template>\r\n\r\n<script>\r\n\timport {addRole,updateRole,getMenuByRoleId} from '@/api/system.js';\r\n\r\n  export default {\r\n    data() {\r\n      return {\r\n        form: this.$form.createForm(this),\r\n        dialogTypeMap: {\r\n          show: '角色详情',\r\n          create: '角色新增',\r\n          update: '角色修改'\r\n        },\r\n        \thackRest:false,\r\n          columns: [\r\n            { title: '菜单ID', dataIndex: 'id',align:'center' },\r\n            { title: '菜单名称', dataIndex: 'name',align:'center' },\r\n            { title: '菜单路径', dataIndex: 'path' ,align:'center'},\r\n  \t\t      { title: '菜单类型', dataIndex: 'type' ,align:'center',scopedSlots: { customRender: 'type' }},\r\n            { title: '父菜单', dataIndex: 'parentName' ,align:'center'},\r\n            { title: '菜单图标', dataIndex: 'icon' ,align:'center',width:'90px',scopedSlots: { customRender: 'icon' }},\r\n            { title: '状态', dataIndex: 'status',align:'center',scopedSlots: { customRender: 'status' } }\r\n          ],\r\n          listQuery:{\r\n            page:1,\r\n            pageSize:5,\r\n            roleId:''\r\n          },\r\n          query:{},\r\n          list:[],\r\n          pagination: {\r\n             total:0,\r\n               defaultPageSize:5,\r\n               showTotal: total => `共 ${total} 条数据`,\r\n               showSizeChanger:true,\r\n               pageSizeOptions: ['5', '10', '15', '20'],\r\n               onChange:(page, pageSize)=>{\r\n                 this.pagechage(page, pageSize);\r\n               },\r\n             onShowSizeChange:(current,pageSize)=>{\r\n               this.pageSizeChange(pageSize);\r\n             }\r\n          },\r\n        SubmitTypeMap: {\r\n          show: '确认',\r\n          create: '提交',\r\n          update: '提交'\r\n        },\r\n\r\n\t\tstatusmap:{\r\n\t\t  '0':'停用',\r\n\t\t  '1':'启用'\r\n\t\t},\r\n\t\ttypemap:{\r\n\t\t  '0':'一级菜单',\r\n\t\t  '1':'二级菜单'\r\n\t\t},\r\n        showVisible: false,\r\n        rule:{\r\n          name:{ rules: [{ required: true, message: '请输入角色姓名' }],initialValue:''},\r\n          desc:{ rules: [{ required: true, message: '请输入角色描述' }],initialValue:''},\r\n          status:{ rules: [{ required: true, message: '请输入角色状态' }],initialValue:''},\r\n        }\r\n      }\r\n    },\r\n    props: {\r\n      showVisible: Boolean\r\n    },\r\n\r\n    methods: {\r\n      //查看\r\n      ShowDialog(query) {\r\n        this.disabled = true\r\n        this.showVisible = true\r\n        this.dialogType = 'show'\r\n          this.query = query\r\n        \tthis.getList(query)\r\n        this.$nextTick(() => {\r\n          this.form.setFieldsValue(query)\r\n        })\r\n      },\r\n\r\n      //获取关联角色信息\r\n      getList(){\r\n        this.loading=true\r\n        this.listQuery.roleId = this.query.id\r\n         getMenuByRoleId(this.listQuery).then(res=>{\r\n          if(res.data.code=='0000'){\r\n            this.loading=false\r\n            console.log(res)\r\n            this.list = res.data.extend.list\r\n            this.pagination.total = res.data.extend.total;\r\n          }else{\r\n            this.loading=false\r\n            this.$message.error(res.data.message)\r\n          }\r\n         })\r\n      },\r\n\r\n      //新增\r\n      CreateDialog() {\r\n        this.disabled = false\r\n        this.showVisible = true\r\n        this.dialogType = 'create'\r\n      },\r\n      //修改\r\n  \t  UpdateDialog(query) {\r\n  \t  \tthis.disabled=false\r\n  \t    this.showVisible = true\r\n  \t  \tthis.dialogType='update'\r\n  \t\t  this.$nextTick(()=>{\r\n          \tthis.hackRest=true;\r\n  \t\t\tthis.form.setFieldsValue(query)\r\n  \t\t});\r\n  \t  },\r\n  \t  //关闭\r\n  \t  onClose(){\r\n  \t\t  this.showVisible = false;\r\n  \t\t  this.form.resetFields();\r\n  \t  },\r\n      //提交按钮\r\n        onSubmit() {\r\n       if(this.dialogType=='show'){\r\n        this.showVisible = false\r\n       }\r\n       if(this.dialogType=='create'){\r\n          this.create();\r\n       }\r\n       if(this.dialogType=='update'){\r\n          this.update();\r\n       }\r\n     },\r\n     create(){\r\n       this.form.validateFields((err, values) => {\r\n         if (err) {\r\n           this.$message.error(\"新增失败！\");\r\n         }else{\r\n          // var listArry=this.form.getFieldsValue()\r\n           //console.log(listArry)\r\n         addRole(values).then(res=>{\r\n           if(res.status==200){\r\n             this.$message.success('新增成功！')\r\n             this.$emit('fresh')\r\n           }else{\r\n             this.$message.error('新增失败！')\r\n           }\r\n           })\r\n           this.showVisible = false\r\n         }\r\n        });\r\n     },\r\n     update(){\r\n        this.form.validateFields((err, values) => {\r\n          console.info(values)\r\n        //  var listArry=this.form.getFieldsValue()\r\n          updateRole(values).then(res=>{\r\n            if(res.status==200){\r\n              this.$message.success('修改成功！')\r\n              this.$emit('fresh')\r\n              this.showVisible = false\r\n            }else{\r\n              this.$message.error('修改失败！')\r\n              this.showVisible = false\r\n            }\r\n          })\r\n        });\r\n        //end update\r\n     },\r\n     pageSizeChange(pageSize){\r\n       this.listQuery.pageNum = 1;\r\n       this.listQuery.pageSize = pageSize;\r\n       this.getList();\r\n     },\r\n     pagechage(pageNum, pageSize){\r\n\r\n       this.listQuery.pageNum= pageNum;\r\n         this.listQuery.pageSize = pageSize;\r\n       this.getList();\r\n     }\r\n\r\n\r\n    }\r\n  }\r\n\r\n</script>\r\n\r\n<style>\r\n  .padding20{\r\n    padding-bottom: 40px;\r\n  }\r\n</style>\r\n"],"sourceRoot":"src/views/role"}]}