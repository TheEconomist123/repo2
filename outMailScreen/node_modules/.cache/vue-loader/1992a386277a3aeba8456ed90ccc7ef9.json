{"remainingRequest":"D:\\mail\\oesbecc\\outMailScreen\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\mail\\oesbecc\\outMailScreen\\src\\views\\mailCfgInfo\\edit.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\mail\\oesbecc\\outMailScreen\\src\\views\\mailCfgInfo\\edit.vue","mtime":1641431074323},{"path":"D:\\mail\\oesbecc\\outMailScreen\\node_modules\\babel-loader\\lib\\index.js","mtime":1640070643981},{"path":"D:\\mail\\oesbecc\\outMailScreen\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1640070690350},{"path":"D:\\mail\\oesbecc\\outMailScreen\\node_modules\\vue-loader\\lib\\index.js","mtime":1640070694148}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport {\r\n  updateMailCfgInfo,updateMailCfgImg,getImgById\r\n} from '@/api/mailCfgInfo.js';\r\n\r\nimport moment from 'moment'\r\nfunction getBase64(file) {\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    reader.readAsDataURL(file);\r\n    reader.onload = () => resolve(reader.result);\r\n    reader.onerror = error => reject(error);\r\n  });\r\n}\r\nexport default {\r\n  data() {\r\n    return {\r\n      showUploadList:{\r\n        showRemoveIcon:false\r\n      },\r\n      showUpload:false,\r\n\r\n      disabled: '',\r\n      disabled1: '',\r\n      showVisible: false,\r\n      form: this.$form.createForm(this),\r\n      hackRest: false,\r\n      dialogType: '',\r\n      dialogTypeMap: {\r\n        show: '邮件详情',\r\n        create: '邮件新增',\r\n        update: '邮件修改',\r\n        updateImg:'修改背景图片'\r\n      },\r\n      SubmitTypeMap: {\r\n        show: '关闭',\r\n        create: '确认新增',\r\n        update: '确认修改',\r\n        updateImg:'关闭'\r\n      },\r\n      showCanel: true,\r\n      rule: {\r\n        id: {\r\n          rules: [{\r\n            required: true,\r\n            message: '请输入员工编号'\r\n          }],\r\n          initialValue: ''\r\n        },\r\n        title: {\r\n          rules: [{\r\n            required: true,\r\n            message: '请输入邮箱主题'\r\n          }],\r\n          initialValue: ''\r\n        },\r\n        pubMail: {\r\n          rules: [{\r\n            required: true,\r\n            message: '请输入发件邮箱'\r\n          }],\r\n          initialValue: ''\r\n        },\r\n        pubMailPass: {\r\n          rules: [{\r\n            required: true,\r\n            message: '请输入邮箱密码'\r\n          }],\r\n          initialValue: ''\r\n        },\r\n        sendTime: {\r\n          rules: [{\r\n            required: true,\r\n            message: '请输入发送时间'\r\n          }],\r\n          initialValue: ''\r\n        },\r\n        desxp: {\r\n          rules: [{\r\n            required: false,\r\n            message: '请输入发送时间'\r\n          }],\r\n          initialValue: ''\r\n        },\r\n        modelContent: {\r\n          rules: [{\r\n            required: true,\r\n            message: '请输入模板内容'\r\n          }],\r\n          initialValue: ''\r\n        },\r\n\r\n\r\n        status: {\r\n          rules: [{\r\n            required: true,\r\n            message: '请选择在职状态'\r\n          }],\r\n          initialValue: '1'\r\n        },\r\n      },\r\n      previewVisible: false,\r\n      previewImage: '',\r\n      fileList: [\r\n      ],\r\n    }\r\n  },\r\n  methods: {\r\n    moment,\r\n    //查看\r\n    ShowDialog(query) {\r\n      this.disabled = true\r\n      this.disabled1 = true\r\n      this.showUpload=false\r\n      this.showCanel = false\r\n      this.showVisible = true\r\n      this.iconType = \"copy\";\r\n      this.dialogType = 'show'\r\n      this.timeTask = query\r\n      this.$nextTick(() => {\r\n        this.hackRest = true;\r\n        this.form.setFieldsValue(query);\r\n        this.fileFormatter();\r\n      });\r\n    },\r\n\r\n    UpdateImgDialog(query) {\r\n      this.disabled = true\r\n      this.disabled1 = true\r\n      this.showUpload=true\r\n      this.showCanel = false\r\n      this.showVisible = true\r\n      this.iconType = \"copy\";\r\n      this.dialogType = 'updateImg'\r\n      this.timeTask = query\r\n      this.$nextTick(() => {\r\n        this.hackRest = true;\r\n        this.form.setFieldsValue(query);\r\n        this.fileFormatter();\r\n      });\r\n    },\r\n\r\n    //\r\n    CreateDialog() {\r\n      this.iconType = \"form\";\r\n      this.showCanel = true\r\n      this.disabled = false\r\n      this.disabled1 = false\r\n      this.showVisible = true\r\n      this.dialogType = 'create'\r\n      this.form.resetFields(); //清除缓存数据\r\n    },\r\n    //修改\r\n    UpdateDialog(query) {\r\n      this.iconType = \"form\";\r\n      this.showCanel = true\r\n      this.disabled = false\r\n      this.disabled1 = true\r\n      this.showUpload=false\r\n      this.showVisible = true\r\n      this.dialogType = 'update'\r\n      this.timeTask = query\r\n      this.$nextTick(() => {\r\n        this.hackRest = true;\r\n        this.form.setFieldsValue(query);\r\n        this.fileFormatter();\r\n      });\r\n\r\n    },\r\n    //关闭\r\n    onClose() {\r\n      this.showVisible = false;\r\n      this.form.resetFields();\r\n    },\r\n    //提交按钮\r\n    onSubmit() {\r\n      if (this.dialogType == 'show' ||this.dialogType =='updateImg') {\r\n        this.showVisible = false\r\n      }\r\n      if (this.dialogType == 'create') {\r\n        this.create();\r\n      }\r\n      if (this.dialogType == 'update') {\r\n        this.update();\r\n      }\r\n    },\r\n\r\n    //修改\r\n    update() {\r\n      this.form.validateFields((err, values) => {\r\n        if (!err) {\r\n          updateMailCfgInfo(values).then(res => {\r\n            //console.log(res)\r\n            if (res.data.code == '0000') {\r\n              this.$message.success(res.data.message)\r\n              this.$emit('fresh')\r\n            } else {\r\n              this.$message.error(res.data.message)\r\n            }\r\n          })\r\n          this.showVisible = false\r\n        }\r\n      });\r\n    },\r\n\r\n    handleCancel() {\r\n      this.previewVisible = false;\r\n    },\r\n    async handlePreview(file) {\r\n      if (!file.url && !file.preview) {\r\n        file.preview = await getBase64(file.originFileObj);\r\n      }\r\n      this.previewImage = file.url || file.preview;\r\n      this.previewVisible = true;\r\n    },\r\n    handleChange({ fileList }) {\r\n      this.fileList = fileList;\r\n    },\r\n\r\n    downloadFilesCustomRequest(data){\r\n\r\n\r\n      const formData = new FormData()\r\n      formData.append('file', data.file);\r\n      formData.append('id', this.form.getFieldValue(\"id\"));\r\n\r\n      updateMailCfgImg(formData).then(res => {\r\n        if (res.data.code == '0000') {\r\n          this.$message.success(res.data.message)\r\n          this.fileFormatter()\r\n        } else {\r\n          this.$message.error(res.data.message)\r\n        }\r\n\r\n\r\n\r\n      })\r\n      return;\r\n    },\r\n\r\n    fileFormatter() {\r\n      //下载文件\r\n      getImgById({id:this.form.getFieldValue(\"id\")}).then(res=>{\r\n        let file = {\r\n          uid: '1',    // 文件唯一标识，建议设置为负数，防止和内部产生的 id 冲突\r\n          name: '背景图片',   // 文件名\r\n          status: 'done', // 状态有：uploading done error removed\r\n        }\r\n        const blob = new Blob([res.data]);\r\n        var href = window.URL.createObjectURL(blob);\r\n        file.url = href;\r\n        this.fileList =[];\r\n        this.fileList.push(file);\r\n      })\r\n\r\n    },\r\n\r\n  }\r\n}\r\n",{"version":3,"sources":["edit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwIA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA","file":"edit.vue","sourceRoot":"src/views/mailCfgInfo","sourcesContent":["<template>\r\n\r\n  <a-drawer placement=\"right\" :closable=\"true\" @close=\"onClose\" :visible=\"showVisible\" width=\"700px\">\r\n\t\t<span slot=\"title\">\r\n\t\t\t<a-icon :type=\"iconType\"/>&nbsp; {{ dialogTypeMap[dialogType] }}\r\n\r\n\t\t</span>\r\n\r\n    <a-form class=\"ant-advanced-search-form\" style=\"border:none;\" :form=\"form\">\r\n      <a-row :gutter=\"24\">\r\n        <a-col :span=\"12\">\r\n          <a-form-item label=\"邮箱编号\" :label-col=\"{ span: 8 }\" :wrapper-col=\"{ span: 16 }\">\r\n            <a-input placeholder=\"请输入邮箱编号\" :disabled=\"disabled1\" v-decorator=\"['id',rule.id]\"/>\r\n          </a-form-item>\r\n        </a-col>\r\n\r\n        <a-col :span=\"12\">\r\n          <a-form-item label=\"发件邮箱\" :label-col=\"{ span: 8 }\" :wrapper-col=\"{ span: 16 }\">\r\n            <a-input placeholder=\"请输入发件邮箱\" :disabled=\"disabled\" v-decorator=\"['pubMail',rule.pubMail]\"/>\r\n          </a-form-item>\r\n        </a-col>\r\n\r\n        <a-col :span=\"12\">\r\n          <a-form-item label=\"邮箱密码\" :label-col=\"{ span: 8 }\" :wrapper-col=\"{ span: 16 }\">\r\n            <a-input type=\"password\" placeholder=\"请输入发件邮箱密码\" :disabled=\"disabled\" v-decorator=\"['pubMailPass',rule.pubMailPass]\"/>\r\n          </a-form-item>\r\n        </a-col>\r\n\r\n\r\n\r\n<!--        <a-col :span=\"24\">\r\n          <a-form-item label=\"出生日期\" :label-col=\"{ span: 4 }\" :wrapper-col=\"{ span: 12 }\">\r\n            <a-date-picker placeholder=\"请输入出生日期\" style=\"width:100%\" :disabled=\"disabled\"\r\n                           v-decorator=\"['birth',rule.birth]\"/>\r\n          </a-form-item>\r\n        </a-col>\r\n\r\n        <a-col :span=\"24\">\r\n          <a-form-item label=\"入职日期\" :label-col=\"{ span: 4 }\" :wrapper-col=\"{ span: 12 }\">\r\n            <a-date-picker placeholder=\"请输入入职日期\" style=\"width:100%\" :disabled=\"disabled\"\r\n                           v-decorator=\"['entry',rule.entry]\"/>\r\n          </a-form-item>\r\n        </a-col>-->\r\n\r\n        <a-col :span=\"12\">\r\n          <a-form-item label=\"发送时间\" :label-col=\"{ span: 8 }\" :wrapper-col=\"{ span: 16 }\">\r\n            <a-time-picker\r\n                            format=\"HH:mm\" placeholder=\"请输入发送时间\"\r\n                            :default-value=\"moment('12:08', 'HH:mm')\"\r\n                            style=\"width:100%\"\r\n                            :disabled=\"disabled\"\r\n                            valueFormat=\"HH:mm\"\r\n                           v-decorator=\"['sendTime',rule.sendTime]\"/>\r\n          </a-form-item>\r\n        </a-col>\r\n        <a-col :span=\"24\">\r\n          <a-form-item label=\"邮箱主题\" :label-col=\"{ span: 4 }\" :wrapper-col=\"{ span: 20 }\">\r\n            <a-input  placeholder=\"请输入邮箱主题\" :disabled=\"disabled\" v-decorator=\"['title',rule.title]\"/>\r\n          </a-form-item>\r\n        </a-col>\r\n\r\n<!--        <a-col :span=\"24\">\r\n          <a-form-item label=\"模板内容\" :label-col=\"{ span: 4 }\" :wrapper-col=\"{ span: 20 }\">\r\n            <a-input type=\"textarea\" :auto-size=\"{ minRows: 5}\"  placeholder=\"请输入模板内容\" :disabled=\"disabled\" v-decorator=\"['modelContent',rule.modelContent]\"/>\r\n          </a-form-item>\r\n        </a-col>-->\r\n\r\n        <a-col :span=\"12\">\r\n          <a-form-item label=\"邮件类型\" :label-col=\"{ span: 8 }\" :wrapper-col=\"{ span: 16 }\">\r\n            <template>\r\n              <a-radio-group name='status' :disabled=\"disabled1\" v-decorator=\"['mailType',rule.mailType]\">\r\n                <a-radio value=\"0\">生日祝福</a-radio>\r\n                <a-radio value=\"1\">感谢信</a-radio>\r\n              </a-radio-group>\r\n            </template>\r\n          </a-form-item>\r\n        </a-col>\r\n        <a-col :span=\"12\">\r\n          <a-form-item label=\"备注\" :label-col=\"{ span: 8 }\" :wrapper-col=\"{ span: 16 }\">\r\n            <a-input placeholder=\"请输入描述信息\" :disabled=\"disabled\" v-decorator=\"['descx',rule.descx]\"/>\r\n          </a-form-item>\r\n        </a-col>\r\n\r\n      <a-col :span=\"24\">\r\n        <a-form-item label=\"背景图片\" :label-col=\"{ span: 4 }\" :wrapper-col=\"{ span: 12 }\">\r\n          <template>\r\n            <a-upload\r\n                list-type=\"picture-card\"\r\n                :file-list=\"fileList\"\r\n                :showUploadList=showUploadList\r\n                @preview=\"handlePreview\"\r\n                :customRequest=\"downloadFilesCustomRequest\" >\r\n              <div v-if=\"showUpload\">\r\n                <a-icon type=\"plus\" />\r\n                <div class=\"ant-upload-text\">\r\n                  上传背景图片\r\n                </div>\r\n              </div>\r\n            </a-upload>\r\n          </template>\r\n        </a-form-item>\r\n      </a-col>\r\n      </a-row>\r\n\r\n\r\n    </a-form>\r\n\r\n\r\n    <div class=\"clearfix\">\r\n\r\n      <a-modal :visible=\"previewVisible\" :footer=\"null\" @cancel=\"handleCancel\">\r\n        <img alt=\"example\" style=\"width: 100%\" :src=\"previewImage\" />\r\n      </a-modal>\r\n    </div>\r\n\r\n\r\n\r\n    <div :style=\"{\r\n                 position: 'absolute',\r\n                 left: 0,\r\n                 bottom: 0,\r\n                 width: '100%',\r\n                 borderTop: '1px solid #e9e9e9',\r\n                 padding: '10px 16px',\r\n                 background: '#fff',\r\n                 textAlign: 'right',\r\n               }\">\r\n      <a-button :style=\"{marginRight: '8px'}\" @click=\"onClose\" v-if=\"showCanel\"> 取消</a-button>\r\n      <a-button @click=\"onSubmit\" type=\"primary\">{{ SubmitTypeMap[dialogType] }}</a-button>\r\n    </div>\r\n\r\n  </a-drawer>\r\n\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  updateMailCfgInfo,updateMailCfgImg,getImgById\r\n} from '@/api/mailCfgInfo.js';\r\n\r\nimport moment from 'moment'\r\nfunction getBase64(file) {\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    reader.readAsDataURL(file);\r\n    reader.onload = () => resolve(reader.result);\r\n    reader.onerror = error => reject(error);\r\n  });\r\n}\r\nexport default {\r\n  data() {\r\n    return {\r\n      showUploadList:{\r\n        showRemoveIcon:false\r\n      },\r\n      showUpload:false,\r\n\r\n      disabled: '',\r\n      disabled1: '',\r\n      showVisible: false,\r\n      form: this.$form.createForm(this),\r\n      hackRest: false,\r\n      dialogType: '',\r\n      dialogTypeMap: {\r\n        show: '邮件详情',\r\n        create: '邮件新增',\r\n        update: '邮件修改',\r\n        updateImg:'修改背景图片'\r\n      },\r\n      SubmitTypeMap: {\r\n        show: '关闭',\r\n        create: '确认新增',\r\n        update: '确认修改',\r\n        updateImg:'关闭'\r\n      },\r\n      showCanel: true,\r\n      rule: {\r\n        id: {\r\n          rules: [{\r\n            required: true,\r\n            message: '请输入员工编号'\r\n          }],\r\n          initialValue: ''\r\n        },\r\n        title: {\r\n          rules: [{\r\n            required: true,\r\n            message: '请输入邮箱主题'\r\n          }],\r\n          initialValue: ''\r\n        },\r\n        pubMail: {\r\n          rules: [{\r\n            required: true,\r\n            message: '请输入发件邮箱'\r\n          }],\r\n          initialValue: ''\r\n        },\r\n        pubMailPass: {\r\n          rules: [{\r\n            required: true,\r\n            message: '请输入邮箱密码'\r\n          }],\r\n          initialValue: ''\r\n        },\r\n        sendTime: {\r\n          rules: [{\r\n            required: true,\r\n            message: '请输入发送时间'\r\n          }],\r\n          initialValue: ''\r\n        },\r\n        desxp: {\r\n          rules: [{\r\n            required: false,\r\n            message: '请输入发送时间'\r\n          }],\r\n          initialValue: ''\r\n        },\r\n        modelContent: {\r\n          rules: [{\r\n            required: true,\r\n            message: '请输入模板内容'\r\n          }],\r\n          initialValue: ''\r\n        },\r\n\r\n\r\n        status: {\r\n          rules: [{\r\n            required: true,\r\n            message: '请选择在职状态'\r\n          }],\r\n          initialValue: '1'\r\n        },\r\n      },\r\n      previewVisible: false,\r\n      previewImage: '',\r\n      fileList: [\r\n      ],\r\n    }\r\n  },\r\n  methods: {\r\n    moment,\r\n    //查看\r\n    ShowDialog(query) {\r\n      this.disabled = true\r\n      this.disabled1 = true\r\n      this.showUpload=false\r\n      this.showCanel = false\r\n      this.showVisible = true\r\n      this.iconType = \"copy\";\r\n      this.dialogType = 'show'\r\n      this.timeTask = query\r\n      this.$nextTick(() => {\r\n        this.hackRest = true;\r\n        this.form.setFieldsValue(query);\r\n        this.fileFormatter();\r\n      });\r\n    },\r\n\r\n    UpdateImgDialog(query) {\r\n      this.disabled = true\r\n      this.disabled1 = true\r\n      this.showUpload=true\r\n      this.showCanel = false\r\n      this.showVisible = true\r\n      this.iconType = \"copy\";\r\n      this.dialogType = 'updateImg'\r\n      this.timeTask = query\r\n      this.$nextTick(() => {\r\n        this.hackRest = true;\r\n        this.form.setFieldsValue(query);\r\n        this.fileFormatter();\r\n      });\r\n    },\r\n\r\n    //\r\n    CreateDialog() {\r\n      this.iconType = \"form\";\r\n      this.showCanel = true\r\n      this.disabled = false\r\n      this.disabled1 = false\r\n      this.showVisible = true\r\n      this.dialogType = 'create'\r\n      this.form.resetFields(); //清除缓存数据\r\n    },\r\n    //修改\r\n    UpdateDialog(query) {\r\n      this.iconType = \"form\";\r\n      this.showCanel = true\r\n      this.disabled = false\r\n      this.disabled1 = true\r\n      this.showUpload=false\r\n      this.showVisible = true\r\n      this.dialogType = 'update'\r\n      this.timeTask = query\r\n      this.$nextTick(() => {\r\n        this.hackRest = true;\r\n        this.form.setFieldsValue(query);\r\n        this.fileFormatter();\r\n      });\r\n\r\n    },\r\n    //关闭\r\n    onClose() {\r\n      this.showVisible = false;\r\n      this.form.resetFields();\r\n    },\r\n    //提交按钮\r\n    onSubmit() {\r\n      if (this.dialogType == 'show' ||this.dialogType =='updateImg') {\r\n        this.showVisible = false\r\n      }\r\n      if (this.dialogType == 'create') {\r\n        this.create();\r\n      }\r\n      if (this.dialogType == 'update') {\r\n        this.update();\r\n      }\r\n    },\r\n\r\n    //修改\r\n    update() {\r\n      this.form.validateFields((err, values) => {\r\n        if (!err) {\r\n          updateMailCfgInfo(values).then(res => {\r\n            //console.log(res)\r\n            if (res.data.code == '0000') {\r\n              this.$message.success(res.data.message)\r\n              this.$emit('fresh')\r\n            } else {\r\n              this.$message.error(res.data.message)\r\n            }\r\n          })\r\n          this.showVisible = false\r\n        }\r\n      });\r\n    },\r\n\r\n    handleCancel() {\r\n      this.previewVisible = false;\r\n    },\r\n    async handlePreview(file) {\r\n      if (!file.url && !file.preview) {\r\n        file.preview = await getBase64(file.originFileObj);\r\n      }\r\n      this.previewImage = file.url || file.preview;\r\n      this.previewVisible = true;\r\n    },\r\n    handleChange({ fileList }) {\r\n      this.fileList = fileList;\r\n    },\r\n\r\n    downloadFilesCustomRequest(data){\r\n\r\n\r\n      const formData = new FormData()\r\n      formData.append('file', data.file);\r\n      formData.append('id', this.form.getFieldValue(\"id\"));\r\n\r\n      updateMailCfgImg(formData).then(res => {\r\n        if (res.data.code == '0000') {\r\n          this.$message.success(res.data.message)\r\n          this.fileFormatter()\r\n        } else {\r\n          this.$message.error(res.data.message)\r\n        }\r\n\r\n\r\n\r\n      })\r\n      return;\r\n    },\r\n\r\n    fileFormatter() {\r\n      //下载文件\r\n      getImgById({id:this.form.getFieldValue(\"id\")}).then(res=>{\r\n        let file = {\r\n          uid: '1',    // 文件唯一标识，建议设置为负数，防止和内部产生的 id 冲突\r\n          name: '背景图片',   // 文件名\r\n          status: 'done', // 状态有：uploading done error removed\r\n        }\r\n        const blob = new Blob([res.data]);\r\n        var href = window.URL.createObjectURL(blob);\r\n        file.url = href;\r\n        this.fileList =[];\r\n        this.fileList.push(file);\r\n      })\r\n\r\n    },\r\n\r\n  }\r\n}\r\n</script>\r\n"]}]}